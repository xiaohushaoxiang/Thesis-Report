\chapter{Discussion}

\textcolor{red}{I thought it best to first discuss the discussion during the meeting, since I am not completely sure what I should write here. Furthermore I also think that this is very dependent on the results that I will be showing throughout this thesis, which is also not yet set at the moment}

For step detection the implementation of Algorithm \ref{algo:step_detect} was compared with that of \citet{Salvi2018}, who had continued the work of \cite{Harle2013}. Within the results there were two observations made. The first was that the performance of both implementations were similar for the different carrying modes in the number of steps that were taken. This is to be expect since \cref{algo:step_detect} is heavily based on the research implementation. The only real difference is that a simple walk detection threshold was added. The  \par 

One of the largest differences is that \cref{algo:step_detect} was applied to the data after recording while the researchers had implemented their method in a real time fashion on an android device. It must also be noted that the researchers did focus on step counting, and did no measurements themselves to determine how close their detections were to the actual steps. \par 

It is unsure what effects the online implement may have had on performance. If a lag was introduced due to computation time, it may also explain the second observation in the results. Here it was found that \cref{algo:step_detect} was able to detect more "unique steps" than the \cite{Salvi2018} approach. It is also debatable how well the unique step approach as a metric is to determining the performance of determining how close a detection is to a step. Another approach could be to calculate the time between each detection and the closest ground truth point


\section{Answering Research Questions}

\textcolor{cyan}{this will depend on the the eventual research questions that are found}

\section{Future Work}

{\color{purple}
\textbf{Step detection}
\begin{itemize}
	\item using data from \cite{Salvi2018} determine if parameters found are also the best parameters for the implementation used in this thesis.
	\item Step detection is a form of activity recognition, investigate if other machine learning techniques can perform better  
	\item testing was performed walking on a hard floor and it will be necessary to investigate softer surfaces like carpet or grass.
	\item Determine robustness against more complex movements
\end{itemize}

\textbf{Step length estimation}
\begin{itemize}
	\item generate more first hand data, maybe in a motion capture lab  
	\item use \cite{Bayev2019}, a data set that has recently been made to develop smartphone based pedestrian navigation 
	\item make the assumption that step length is constant and determine effect on performance
	\item when making a turn both feet do not travel the same distance. The inside foot will make a smaller step, while the outer a large one. Determine how turning affects the step length estimation.
\end{itemize}

\textbf{Orientation estimation}
\begin{itemize}
	\item use the method of \cite{Michel2018} to handle magnetic field disturbances
\end{itemize}

\textbf{Step heading estimation}
\begin{itemize}
	\item The testing was limited to one carrying mode, so that the yaw of the device would represent the direction in which the test subject is moving. Step heading estimation will need to be applied in order for the phone to be in other carrying modes.
\end{itemize}

\textbf{Particle filter}
\begin{itemize}
	\item Test without furniture or with a different probability density for furniture
	\item decrease probability close to walls since people do not generally walk close to walls
	\item different representation of map, instead of grid based more node and edge approach. 
	\item be able to detect when moving to a different floor
	\item combine other drift reduction methods
	\item initialize particles over whole map instead of defining a starting point.
	\item find a way to use less particles in order to be implementable on portable device. Above solutions could already help with this.
\end{itemize}

\textbf{Activity Recognition}
\begin{itemize}
	\item Detect more useful activities that can be used as additional particle filter measurement update. For example, climbing stairs for only smartphone sensors, or more intricate activities such as cooking
	\item implement activity recognition locally on device so little inter device communication is required.
\end{itemize}

\textbf{Testing}
\begin{itemize}
	\item different building testing. The current contained may different ways of walking around, while other buildings with more corridor structures are more restrictive. Potentially the SHS-PF technique could have better performance in these settings.
	\item better ground truth determination for both positioning and orientation. ORB-SLAM2 was tried but could not get it to work with footage from phone.
	\item online calculation of position on device
	\item test with different people to determine how user sensitive this is.
\end{itemize}}
